{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import Button from'react-bootstrap/Button';import ClientesForm from'../ClientesForm/ClientesForm';import{useAuth}from'../../context/AuthContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ClienteList=()=>{const[clientes,setClientes]=useState([]);const[loading,setLoading]=useState(true);const[editCliente,setEditCliente]=useState(null);const{user}=useAuth();// Cambiamos currentUser a user para que coincida con el contexto\nuseEffect(()=>{const fetchClientes=async()=>{setLoading(true);try{if(user){// Verificamos si el usuario está autenticado\nconst token=await user.getIdToken();// Obtenemos el token del usuario autenticado\nconst response=await axios.get('http://localhost:3001/api/clientes',{headers:{Authorization:\"Bearer \".concat(token)}});setClientes(response.data);}else{console.error(\"Usuario no autenticado\");}}catch(error){console.error('Error fetching clients:',error);}finally{setLoading(false);}};fetchClientes();},[user]);// Dependemos de user en lugar de currentUser\nconst handleAddCliente=async cliente=>{setLoading(true);try{if(user){const token=await user.getIdToken();const response=await axios.post('http://localhost:3001/api/clientes',cliente,{headers:{Authorization:\"Bearer \".concat(token)}});setClientes(prevClientes=>[...prevClientes,response.data]);}}catch(error){console.error('Error adding client:',error);}finally{setLoading(false);}};const handleUpdateCliente=async(id,updatedCliente)=>{setLoading(true);try{if(user){const token=await user.getIdToken();await axios.put(\"http://localhost:3001/api/clientes/\".concat(id),updatedCliente,{headers:{Authorization:\"Bearer \".concat(token)}});setClientes(prevClientes=>prevClientes.map(cliente=>cliente.id===id?{...cliente,...updatedCliente}:cliente));}}catch(error){console.error('Error updating client:',error);}finally{setLoading(false);setEditCliente(null);}};const handleDeleteCliente=async id=>{setLoading(true);try{if(user){const token=await user.getIdToken();await axios.delete(\"http://localhost:3001/api/clientes/\".concat(id),{headers:{Authorization:\"Bearer \".concat(token)}});setClientes(prevClientes=>prevClientes.filter(cliente=>cliente.id!==id));}}catch(error){console.error('Error deleting client:',error);}finally{setLoading(false);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Lista de Clientes\"}),clientes.map(cliente=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Nombre: \",cliente.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"CUIT: \",cliente.cuit]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Email: \",cliente.email]}),/*#__PURE__*/_jsx(Button,{className:\"mx-2\",onClick:()=>setEditCliente(cliente),children:\"Editar\"}),/*#__PURE__*/_jsx(Button,{onClick:()=>handleDeleteCliente(cliente.id),children:\"Eliminar\"}),/*#__PURE__*/_jsx(\"hr\",{})]},cliente.id)),editCliente&&/*#__PURE__*/_jsx(ClientesForm,{initialData:editCliente,onSave:updatedCliente=>handleUpdateCliente(editCliente.id,updatedCliente)}),/*#__PURE__*/_jsx(ClientesForm,{onSave:handleAddCliente})]});};export default ClienteList;","map":{"version":3,"names":["React","useState","useEffect","axios","Button","ClientesForm","useAuth","jsx","_jsx","jsxs","_jsxs","ClienteList","clientes","setClientes","loading","setLoading","editCliente","setEditCliente","user","fetchClientes","token","getIdToken","response","get","headers","Authorization","concat","data","console","error","handleAddCliente","cliente","post","prevClientes","handleUpdateCliente","id","updatedCliente","put","map","handleDeleteCliente","delete","filter","children","name","cuit","email","className","onClick","initialData","onSave"],"sources":["C:/Users/guill/OneDrive/Documents/UADE/TP/equipo1-ecommerce/equipo1-ecommerce/src/components/ClientesList/ClientesList.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport Button from 'react-bootstrap/Button';\r\nimport ClientesForm from '../ClientesForm/ClientesForm';\r\nimport { useAuth } from '../../context/AuthContext'; \r\n\r\nconst ClienteList = () => {\r\n  const [clientes, setClientes] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [editCliente, setEditCliente] = useState(null);\r\n  const { user } = useAuth(); // Cambiamos currentUser a user para que coincida con el contexto\r\n\r\n  useEffect(() => {\r\n    const fetchClientes = async () => {\r\n      setLoading(true);\r\n      try {\r\n        if (user) { // Verificamos si el usuario está autenticado\r\n          const token = await user.getIdToken(); // Obtenemos el token del usuario autenticado\r\n          const response = await axios.get('http://localhost:3001/api/clientes', {\r\n            headers: { Authorization: `Bearer ${token}` }\r\n          });\r\n          setClientes(response.data);\r\n        } else {\r\n          console.error(\"Usuario no autenticado\");\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching clients:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchClientes();\r\n  }, [user]); // Dependemos de user en lugar de currentUser\r\n\r\n  const handleAddCliente = async (cliente) => {\r\n    setLoading(true);\r\n    try {\r\n      if (user) {\r\n        const token = await user.getIdToken();\r\n        const response = await axios.post('http://localhost:3001/api/clientes', cliente, {\r\n          headers: { Authorization: `Bearer ${token}` }\r\n        });\r\n        setClientes((prevClientes) => [...prevClientes, response.data]);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error adding client:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleUpdateCliente = async (id, updatedCliente) => {\r\n    setLoading(true);\r\n    try {\r\n      if (user) {\r\n        const token = await user.getIdToken();\r\n        await axios.put(`http://localhost:3001/api/clientes/${id}`, updatedCliente, {\r\n          headers: { Authorization: `Bearer ${token}` }\r\n        });\r\n        setClientes((prevClientes) =>\r\n          prevClientes.map((cliente) =>\r\n            cliente.id === id ? { ...cliente, ...updatedCliente } : cliente\r\n          )\r\n        );\r\n      }\r\n    } catch (error) {\r\n      console.error('Error updating client:', error);\r\n    } finally {\r\n      setLoading(false);\r\n      setEditCliente(null);\r\n    }\r\n  };\r\n\r\n  const handleDeleteCliente = async (id) => {\r\n    setLoading(true);\r\n    try {\r\n      if (user) {\r\n        const token = await user.getIdToken();\r\n        await axios.delete(`http://localhost:3001/api/clientes/${id}`, {\r\n          headers: { Authorization: `Bearer ${token}` }\r\n        });\r\n        setClientes((prevClientes) =>\r\n          prevClientes.filter((cliente) => cliente.id !== id)\r\n        );\r\n      }\r\n    } catch (error) {\r\n      console.error('Error deleting client:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return <div>Loading...</div>;\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h1>Lista de Clientes</h1>\r\n\r\n      {clientes.map((cliente) => (\r\n        <div key={cliente.id}>\r\n          <p>Nombre: {cliente.name}</p>\r\n          <p>CUIT: {cliente.cuit}</p>\r\n          <p>Email: {cliente.email}</p>\r\n          <Button className='mx-2' onClick={() => setEditCliente(cliente)}>Editar</Button>\r\n          <Button onClick={() => handleDeleteCliente(cliente.id)}>Eliminar</Button>\r\n          <hr />\r\n        </div>\r\n      ))}\r\n      {editCliente && (\r\n        <ClientesForm\r\n          initialData={editCliente}\r\n          onSave={(updatedCliente) => handleUpdateCliente(editCliente.id, updatedCliente)}\r\n        />\r\n      )}\r\n      <ClientesForm onSave={handleAddCliente} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ClienteList;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}