{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.withTimeout = void 0;\nvar tslib_1 = require(\"tslib\");\n/* eslint-disable @typescript-eslint/no-explicit-any */\nvar errors_1 = require(\"./errors\");\nfunction withTimeout(sync, timeout, timeoutError) {\n  var _this = this;\n  if (timeoutError === void 0) {\n    timeoutError = errors_1.E_TIMEOUT;\n  }\n  return {\n    acquire: function (weightOrPriority, priority) {\n      var weight;\n      if (isSemaphore(sync)) {\n        weight = weightOrPriority;\n      } else {\n        weight = undefined;\n        priority = weightOrPriority;\n      }\n      if (weight !== undefined && weight <= 0) {\n        throw new Error(\"invalid weight \".concat(weight, \": must be positive\"));\n      }\n      return new Promise(function (resolve, reject) {\n        return tslib_1.__awaiter(_this, void 0, void 0, function () {\n          var isTimeout, handle, ticket, release, e_1;\n          return tslib_1.__generator(this, function (_a) {\n            switch (_a.label) {\n              case 0:\n                isTimeout = false;\n                handle = setTimeout(function () {\n                  isTimeout = true;\n                  reject(timeoutError);\n                }, timeout);\n                _a.label = 1;\n              case 1:\n                _a.trys.push([1, 3,, 4]);\n                return [4 /*yield*/, isSemaphore(sync) ? sync.acquire(weight, priority) : sync.acquire(priority)];\n              case 2:\n                ticket = _a.sent();\n                if (isTimeout) {\n                  release = Array.isArray(ticket) ? ticket[1] : ticket;\n                  release();\n                } else {\n                  clearTimeout(handle);\n                  resolve(ticket);\n                }\n                return [3 /*break*/, 4];\n              case 3:\n                e_1 = _a.sent();\n                if (!isTimeout) {\n                  clearTimeout(handle);\n                  reject(e_1);\n                }\n                return [3 /*break*/, 4];\n              case 4:\n                return [2 /*return*/];\n            }\n          });\n        });\n      });\n    },\n    runExclusive: function (callback, weight, priority) {\n      return tslib_1.__awaiter(this, void 0, void 0, function () {\n        var release, ticket;\n        return tslib_1.__generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              release = function () {\n                return undefined;\n              };\n              _a.label = 1;\n            case 1:\n              _a.trys.push([1,, 7, 8]);\n              return [4 /*yield*/, this.acquire(weight, priority)];\n            case 2:\n              ticket = _a.sent();\n              if (!Array.isArray(ticket)) return [3 /*break*/, 4];\n              release = ticket[1];\n              return [4 /*yield*/, callback(ticket[0])];\n            case 3:\n              return [2 /*return*/, _a.sent()];\n            case 4:\n              release = ticket;\n              return [4 /*yield*/, callback()];\n            case 5:\n              return [2 /*return*/, _a.sent()];\n            case 6:\n              return [3 /*break*/, 8];\n            case 7:\n              release();\n              return [7 /*endfinally*/];\n            case 8:\n              return [2 /*return*/];\n          }\n        });\n      });\n    },\n    release: function (weight) {\n      sync.release(weight);\n    },\n    cancel: function () {\n      return sync.cancel();\n    },\n    waitForUnlock: function (weightOrPriority, priority) {\n      var weight;\n      if (isSemaphore(sync)) {\n        weight = weightOrPriority;\n      } else {\n        weight = undefined;\n        priority = weightOrPriority;\n      }\n      if (weight !== undefined && weight <= 0) {\n        throw new Error(\"invalid weight \".concat(weight, \": must be positive\"));\n      }\n      return new Promise(function (resolve, reject) {\n        var handle = setTimeout(function () {\n          return reject(timeoutError);\n        }, timeout);\n        (isSemaphore(sync) ? sync.waitForUnlock(weight, priority) : sync.waitForUnlock(priority)).then(function () {\n          clearTimeout(handle);\n          resolve();\n        });\n      });\n    },\n    isLocked: function () {\n      return sync.isLocked();\n    },\n    getValue: function () {\n      return sync.getValue();\n    },\n    setValue: function (value) {\n      return sync.setValue(value);\n    }\n  };\n}\nexports.withTimeout = withTimeout;\nfunction isSemaphore(sync) {\n  return sync.getValue !== undefined;\n}","map":{"version":3,"names":["Object","defineProperty","exports","value","withTimeout","tslib_1","require","errors_1","sync","timeout","timeoutError","_this","E_TIMEOUT","acquire","weightOrPriority","priority","weight","isSemaphore","undefined","Error","concat","Promise","resolve","reject","__awaiter","isTimeout","handle","ticket","release","e_1","__generator","_a","label","setTimeout","trys","push","sent","Array","isArray","clearTimeout","runExclusive","callback","cancel","waitForUnlock","then","isLocked","getValue","setValue"],"sources":["C:/Users/guill/OneDrive/Documents/UADE/TP/equipo1-ecommerce/equipo1-ecommerce/node_modules/async-mutex/lib/withTimeout.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.withTimeout = void 0;\nvar tslib_1 = require(\"tslib\");\n/* eslint-disable @typescript-eslint/no-explicit-any */\nvar errors_1 = require(\"./errors\");\nfunction withTimeout(sync, timeout, timeoutError) {\n    var _this = this;\n    if (timeoutError === void 0) { timeoutError = errors_1.E_TIMEOUT; }\n    return {\n        acquire: function (weightOrPriority, priority) {\n            var weight;\n            if (isSemaphore(sync)) {\n                weight = weightOrPriority;\n            }\n            else {\n                weight = undefined;\n                priority = weightOrPriority;\n            }\n            if (weight !== undefined && weight <= 0) {\n                throw new Error(\"invalid weight \".concat(weight, \": must be positive\"));\n            }\n            return new Promise(function (resolve, reject) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                var isTimeout, handle, ticket, release, e_1;\n                return tslib_1.__generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            isTimeout = false;\n                            handle = setTimeout(function () {\n                                isTimeout = true;\n                                reject(timeoutError);\n                            }, timeout);\n                            _a.label = 1;\n                        case 1:\n                            _a.trys.push([1, 3, , 4]);\n                            return [4 /*yield*/, (isSemaphore(sync)\n                                    ? sync.acquire(weight, priority)\n                                    : sync.acquire(priority))];\n                        case 2:\n                            ticket = _a.sent();\n                            if (isTimeout) {\n                                release = Array.isArray(ticket) ? ticket[1] : ticket;\n                                release();\n                            }\n                            else {\n                                clearTimeout(handle);\n                                resolve(ticket);\n                            }\n                            return [3 /*break*/, 4];\n                        case 3:\n                            e_1 = _a.sent();\n                            if (!isTimeout) {\n                                clearTimeout(handle);\n                                reject(e_1);\n                            }\n                            return [3 /*break*/, 4];\n                        case 4: return [2 /*return*/];\n                    }\n                });\n            }); });\n        },\n        runExclusive: function (callback, weight, priority) {\n            return tslib_1.__awaiter(this, void 0, void 0, function () {\n                var release, ticket;\n                return tslib_1.__generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            release = function () { return undefined; };\n                            _a.label = 1;\n                        case 1:\n                            _a.trys.push([1, , 7, 8]);\n                            return [4 /*yield*/, this.acquire(weight, priority)];\n                        case 2:\n                            ticket = _a.sent();\n                            if (!Array.isArray(ticket)) return [3 /*break*/, 4];\n                            release = ticket[1];\n                            return [4 /*yield*/, callback(ticket[0])];\n                        case 3: return [2 /*return*/, _a.sent()];\n                        case 4:\n                            release = ticket;\n                            return [4 /*yield*/, callback()];\n                        case 5: return [2 /*return*/, _a.sent()];\n                        case 6: return [3 /*break*/, 8];\n                        case 7:\n                            release();\n                            return [7 /*endfinally*/];\n                        case 8: return [2 /*return*/];\n                    }\n                });\n            });\n        },\n        release: function (weight) {\n            sync.release(weight);\n        },\n        cancel: function () {\n            return sync.cancel();\n        },\n        waitForUnlock: function (weightOrPriority, priority) {\n            var weight;\n            if (isSemaphore(sync)) {\n                weight = weightOrPriority;\n            }\n            else {\n                weight = undefined;\n                priority = weightOrPriority;\n            }\n            if (weight !== undefined && weight <= 0) {\n                throw new Error(\"invalid weight \".concat(weight, \": must be positive\"));\n            }\n            return new Promise(function (resolve, reject) {\n                var handle = setTimeout(function () { return reject(timeoutError); }, timeout);\n                (isSemaphore(sync)\n                    ? sync.waitForUnlock(weight, priority)\n                    : sync.waitForUnlock(priority)).then(function () {\n                    clearTimeout(handle);\n                    resolve();\n                });\n            });\n        },\n        isLocked: function () { return sync.isLocked(); },\n        getValue: function () { return sync.getValue(); },\n        setValue: function (value) { return sync.setValue(value); },\n    };\n}\nexports.withTimeout = withTimeout;\nfunction isSemaphore(sync) {\n    return sync.getValue !== undefined;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}